"use strict";(("undefined"!==typeof self?self:this)["webpackChunkEditEntity"]=("undefined"!==typeof self?self:this)["webpackChunkEditEntity"]||[]).push([[863],{3863:function(t,e,n){n.r(e),n.d(e,{default:function(){return F}});var i=function(){var t=this,e=t._self._c;return e("div",[e("modalForm",{attrs:{"title-modal":t.titleModal,"manage-modal":t.manageModal},on:{closeModal:t.closeModal},scopedSlots:t._u([{key:"header",fn:function(){return[e("HCardIcon",{attrs:{"with-mb":!1},scopedSlots:t._u([{key:"titre",fn:function(){return[e("span",[t._v(" Modifier le contenu ")])]},proxy:!0},{key:"default",fn:function(){return[e("span",[t._v(" Veillez remplir les champs ci-dessous et enregistrer ")]),e("br"),e("span",[t._v(" En cas de probleme ou d'incomprehension , veillez nous "),e("a",{attrs:{href:"#"}},[t._v(" laisser un message ")])])]},proxy:!0}])})]},proxy:!0}])})],1)},o=[],a=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"b-modal-manage-project",title:"BootstrapVue",size:"lg","footer-bg-variant":"light","header-bg-variant":"light","body-class":"edit-entity-in-modal","hide-footer":!1,"no-close-on-backdrop":!1},on:{ok:t.handleOk},scopedSlots:t._u([{key:"modal-header",fn:function(){return[t._t("header")]},proxy:!0},{key:"default",fn:function(){return[e("formEdit",{ref:"formEdit"})]},proxy:!0},{key:"modal-footer",fn:function({cancel:n}){return[e("b-button",{class:t.waiting?"save-wait":"",attrs:{disabled:t.waiting,size:"md",variant:"info"},on:{click:t.handleOk}},[e("b-icon",{attrs:{icon:"save2",variant:"white"}}),e("span",[t._v(" Enregister ")]),t.waiting?e("svgWaiting"):t._e()],1),e("b-button",{attrs:{disabled:t.waiting,size:"md",variant:"outline-secondary"},on:{click:function(t){return n()}}},[t._v(" Annuler ")])]}}],null,!0),model:{value:t.openModel,callback:function(e){t.openModel=e},expression:"openModel"}})},r=[],s=function(){var t=this,e=t._self._c;return e("div",[t.show?e("b-form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)},reset:t.onReset}},t._l(t.buildFields(),(function(n,i){return e(n.template,{key:i,tag:"component",attrs:{entity:n.entity,"class-entity":["pt-1"]}},t._l(n.fields,(function(n,o){return e(n.template,{key:o,tag:"component",attrs:{field:n.field,model:n.model,entities:n.entities,"class-css":["mb-5"],"parent-name":i+".entity.","parent-child-name":i+".entities.","namespace-store":""},on:{addNewValue:function(e){return t.addNewValue(e,n)},removeField:function(e){return t.removeField(e,n)},array_move:function(e){return t.array_move(e,n)}}})})),1)})),1):t._e()],1)},l=[],d=(n(7658),n(6389)),u=n(8822),c=n(274),m=n(4842),h={props:{showSubmit:{type:Boolean,default:!1}},data(){return{show:!0}},computed:{...(0,u.rn)({currentEntityForm:t=>t.currentEntityForm}),idEntity(){if(""!==this.form.label){var t=d.Z.generateIdEntityType(this.form.label);return this.setId(t),t}return""}},methods:{onSubmit(t){this.submit()},submit(){return this.$store.dispatch("saveEntities")},onReset(t){t.preventDefault(),this.show=!1,this.$nextTick((()=>{this.show=!0}))},setId(t){this.form.uuid||(this.form.id=t)},buildFields(){var t=[];return m.Z.setConfig(d.Z),console.log(" this.currentEntityForm  :",this.currentEntityForm),this.currentEntityForm.length&&(t=c.Z.generateFields(this.currentEntityForm,t)),t},addNewValue(t,e){this.model[e.field.name].push(t)},removeField(t,e){this.model[e.field.name].splice(t,1)},array_move(t,e){const n=(t,e,n)=>{let i=t.splice(e,1);return t.splice(n,0,i[0]),t},i=n(this.model[e.field.name],t.oldIndex,t.newIndex);this.$store.dispatch("setValue",{value:i,fieldName:e.field.name})}}},f=h,p=n(1001),y=(0,p.Z)(f,s,l,!1,null,null,null),g=y.exports,v={components:{formEdit:g,svgWaiting:()=>n.e(154).then(n.bind(n,5154))},props:{manageModal:{type:Boolean,default:!1}},data(){return{waiting:!1}},computed:{openModel:{get(){return!!this.manageModal},set(t){this.$emit("closeModal",t)}}},methods:{handleOk(t){t.preventDefault(),this.waiting||(this.waiting=!0,this.$refs.formEdit.submit().then((()=>{this.$bvModal.hide("b-modal-manage-project"),window.location.assign(window.location.pathname),this.waiting=!1})).catch((t=>{console.log("error : ",t),this.waiting=!1})))}}},b=v,_=(0,p.Z)(b,a,r,!1,null,null,null),E=_.exports,w={name:"EditEntity",components:{modalForm:E},data(){return{titleModal:"",manageModal:!1}},computed:{...(0,u.rn)({currentEntityInfo:t=>t.currentEntityInfo})},mounted(){this.check_edit_entity()},methods:{check_edit_entity(){document.addEventListener("formatage_models_data_quick_edit_vuejs",(t=>{t.detail&&t.detail.id&&(this.currentEntityInfo.id&&t.detail.id!=this.currentEntityInfo.id?this.$store.dispatch("cleanDatas").then((()=>{this.initEdit(t)})):this.initEdit(t))}),!1)},initEdit(t){console.log("initEdit : ",t.detail),this.openModal(),this.$store.dispatch("set_currentEntityForm",t.detail).then((()=>{this.$store.dispatch("loadForm")}))},openModal(){this.manageModal?this.manageModal=!1:this.manageModal=!0},closeModal(){this.manageModal=!1}}},k=w,M=(0,p.Z)(k,i,o,!1,null,null,null),F=M.exports}}]);
//# sourceMappingURL=EditEntity.umd.min.863.js.map